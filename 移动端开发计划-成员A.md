# ç§»åŠ¨ç«¯å¼€å‘è®¡åˆ’ - æˆå‘˜Aï¼ˆæ–¹æ¡ˆAï¼‰

> åˆ›å»ºæ—¥æœŸï¼š2025-02-13
> è´Ÿè´£äººï¼šæˆå‘˜A
> è´Ÿè´£æ¨¡å—ï¼šé…’åº—æŸ¥è¯¢é¡µï¼ˆé¦–é¡µï¼‰ã€é…’åº—åˆ—è¡¨é¡µã€é…’åº—è¯¦æƒ…é¡µ
> åˆ›æ–°åŠŸèƒ½ï¼šè™šæ‹Ÿæ»šåŠ¨ã€LBSå®šä½æœç´¢

---

## ğŸ“‹ å¼€å‘æ¨¡å¼ï¼šå…ˆMockåè”è°ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ¨¡å¼äºŒï¼šå…ˆMockåè”è°ƒ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  Day 1-3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ç§»åŠ¨ç«¯ç‹¬ç«‹å¼€å‘ï¼Œä½¿ç”¨Mockæ•°æ®                        â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚        â”‚
â”‚  â”‚  â”‚ mockApi.ts   â”‚ â”€â”€â”€â†’â”‚  Taroé¡µé¢     â”‚           â”‚        â”‚
â”‚  â”‚  â”‚              â”‚      â”‚  (å®Œå…¨ç‹¬ç«‹)  â”‚           â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                               â”‚
â”‚  Day 4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  ç§»åŠ¨ç«¯A      â”‚  â†â†’   â”‚   åç«¯C        â”‚              â”‚
â”‚  â”‚  æ›¿æ¢APIè°ƒç”¨   â”‚        â”‚  APIå·²å°±ç»ª      â”‚              â”‚
â”‚  â”‚  å¼€å§‹çœŸå®è”è°ƒ  â”‚        â”‚                 â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Taro ç§»åŠ¨ç«¯ Mock æ•°æ®å®ç°

```typescript
/**
 * services/mockApi.ts
 * Taro ç§»åŠ¨ç«¯ Mock APIæœåŠ¡
 */

import Taro from '@tarojs/taro';

// æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
const delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));

// Mocké…’åº—æ•°æ®
export const mockHotels = [
  {
    id: '1',
    name: 'æ˜“å®¿ç²¾é€‰é…’åº—ï¼ˆåŒ—äº¬æœé˜³åº—ï¼‰',
    address: 'åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·',
    distance: 1.2, // è·ç¦»ï¼ˆå…¬é‡Œï¼‰
    rating: 4.8,
    price: 299,
    originalPrice: 399,
    images: [
      'https://picsum.photos/400/300?random=1',
      'https://picsum.photos/400/300?random=2',
    ],
    tags: ['è¿‘åœ°é“', 'å…è´¹åœè½¦', 'å«æ—©é¤'],
    facilities: ['WiFi', 'ç©ºè°ƒ', 'çƒ­æ°´å™¨', 'ç”µè§†'],
    roomTypes: [
      { id: 'r1', name: 'æ ‡å‡†å¤§åºŠæˆ¿', price: 299, area: '25ã¡', stock: 10 },
      { id: 'r2', name: 'è±ªååŒåºŠæˆ¿', price: 399, area: '35ã¡', stock: 5 },
      { id: 'r3', name: 'å•†åŠ¡å¥—æˆ¿', price: 599, area: '50ã¡', stock: 3 },
    ],
    location: { lat: 39.9042, lng: 116.4074 }, // ç»çº¬åº¦
  },
  {
    id: '2',
    name: 'æ˜“å®¿ç²¾é€‰é…’åº—ï¼ˆä¸Šæµ·æµ¦ä¸œåº—ï¼‰',
    address: 'ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºä¸–çºªå¤§é“100å·',
    distance: 0.8,
    rating: 4.9,
    price: 399,
    originalPrice: 499,
    images: [
      'https://picsum.photos/400/300?random=3',
      'https://picsum.photos/400/300?random=4',
    ],
    tags: ['æ±Ÿæ™¯æˆ¿', 'å¥èº«æˆ¿', 'æ¸¸æ³³æ± '],
    facilities: ['WiFi', 'ç©ºè°ƒ', 'å†°ç®±', 'æ´—è¡£æœº'],
    roomTypes: [
      { id: 'r4', name: 'æ±Ÿæ™¯å¤§åºŠæˆ¿', price: 499, area: '30ã¡', stock: 8 },
    ],
    location: { lat: 31.2304, lng: 121.4737 },
  },
  // ... æ›´å¤šMockæ•°æ®
];

/**
 * æœç´¢é…’åº—ï¼ˆå«åˆ†é¡µï¼‰
 * GET /api/hotels
 */
export const searchHotelsApi = async (params: {
  keyword?: string;
  checkIn?: string;
  checkOut?: string;
  location?: { lat: number; lng: number };
  sortBy?: 'price' | 'distance' | 'rating';
  page: number;
  pageSize: number;
}) => {
  await delay(300); // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ

  let list = [...mockHotels];

  // å…³é”®è¯ç­›é€‰
  if (params.keyword) {
    list = list.filter(h =>
      h.name.includes(params.keyword!) || h.address.includes(params.keyword!)
    );
  }

  // è·ç¦»æ’åºï¼ˆå¦‚æœæœ‰å®šä½ï¼‰
  if (params.location && params.sortBy === 'distance') {
    list = list.map(h => ({
      ...h,
      distance: calculateDistance(params.location!, h.location),
    })).sort((a, b) => a.distance - b.distance);
  }

  // ä»·æ ¼æ’åº
  if (params.sortBy === 'price') {
    list.sort((a, b) => a.price - b.price);
  }

  // è¯„åˆ†æ’åº
  if (params.sortBy === 'rating') {
    list.sort((a, b) => b.rating - a.rating);
  }

  // åˆ†é¡µ
  const start = (params.page - 1) * params.pageSize;
  const end = start + params.pageSize;
  const pageData = list.slice(start, end);

  return {
    success: true,
    data: pageData,
    total: list.length,
    hasMore: end < list.length,
  };
};

/**
 * è·å–é…’åº—è¯¦æƒ…
 * GET /api/hotels/:id
 */
export const getHotelDetailApi = async (id: string) => {
  await delay(200);

  const hotel = mockHotels.find(h => h.id === id);

  if (!hotel) {
    return { success: false, message: 'é…’åº—ä¸å­˜åœ¨' };
  }

  return {
    success: true,
    data: hotel,
  };
};

/**
 * è·å–å®šä½ï¼ˆLBSï¼‰
 */
export const getLocationApi = async (): Promise<{
  lat: number;
  lng: number;
  address?: string;
}> => {
  await delay(500);

  // H5ç¯å¢ƒä½¿ç”¨æµè§ˆå™¨API
  if (process.env.TARO_ENV === 'h5') {
    return new Promise((resolve, reject) => {
      if (!navigator.geolocation) {
        reject(new Error('æµè§ˆå™¨ä¸æ”¯æŒå®šä½'));
        return;
      }

      navigator.geolocation.getCurrentPosition(
        position => {
          resolve({
            lat: position.coords.latitude,
            lng: position.coords.longitude,
          });
        },
        error => {
          // å®šä½å¤±è´¥ï¼Œè¿”å›é»˜è®¤ä½ç½®ï¼ˆå¤©å®‰é—¨ï¼‰
          console.warn('å®šä½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®', error);
          resolve({ lat: 39.9042, lng: 116.4074 });
        },
        { timeout: 5000 }
      );
    });
  }

  // å°ç¨‹åºç¯å¢ƒä½¿ç”¨ Taro API
  if (process.env.TARO_ENV === 'weapp') {
    try {
      const res = await Taro.getLocation();
      return {
        lat: res.latitude,
        lng: res.longitude,
      };
    } catch (error) {
      console.warn('å®šä½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®', error);
      return { lat: 39.9042, lng: 116.4074 };
    }
  }

  // é»˜è®¤ä½ç½®
  return { lat: 39.9042, lng: 116.4074 };
};

/**
 * è®¡ç®—ä¸¤ç‚¹é—´è·ç¦»ï¼ˆå…¬é‡Œï¼‰
 */
function calculateDistance(
  from: { lat: number; lng: number },
  to: { lat: number; lng: number }
): number {
  const R = 6371; // åœ°çƒåŠå¾„ï¼ˆå…¬é‡Œï¼‰
  const dLat = toRad(to.lat - from.lat);
  const dLng = toRad(to.lng - from.lng);

  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(toRad(from.lat)) *
      Math.cos(toRad(to.lat)) *
      Math.sin(dLng / 2) *
      Math.sin(dLng / 2);

  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return Math.round(R * c * 10) / 10; // ä¿ç•™ä¸€ä½å°æ•°
}

function toRad(degrees: number): number {
  return degrees * (Math.PI / 180);
}
```

---

## ğŸ“… ä¸¤å‘¨è¯¦ç»†å¼€å‘è®¡åˆ’

### Week 1ï¼šåŸºç¡€æ­å»º + æ ¸å¿ƒåŠŸèƒ½

| å¤©æ•° | å¼€å‘ä»»åŠ¡ | è¯¦ç»†å†…å®¹ | Gitåˆ†æ”¯ | Commitç¤ºä¾‹ |
|-----|---------|---------|---------|-----------|
| **Day 1** | ç¯å¢ƒæ­å»º + é¡¹ç›®åˆå§‹åŒ– | 1. åˆå§‹åŒ–Taroé¡¹ç›®<br>2. å®‰è£…NutUI/Taro UI<br>3. **åˆ›å»ºmockApi.ts**<br>4. é…ç½®è·¯ç”±<br>5. å®‰è£…Day.js | `feature/setup-mobile` | `feat: åˆå§‹åŒ–Taroé¡¹ç›®`<br>`feat: å®‰è£…å¹¶é…ç½®NutUIç»„ä»¶åº“`<br>`feat: åˆ›å»ºMock APIæœåŠ¡`<br>`feat: é…ç½®Taro Router` |
| **Day 2** | é¦–é¡µæ¡†æ¶ + æœç´¢è¡¨å• | 1. é¦–é¡µå¸ƒå±€<br>2. æœç´¢è¡¨å•ï¼ˆç›®çš„åœ°ã€æ—¥æœŸï¼‰<br>3. æ—¥å†ç»„ä»¶é›†æˆ<br>4. **è°ƒç”¨searchHotelsApiï¼ˆMockï¼‰** | `feature/home-page` | `feat: å®ç°é¦–é¡µå¸ƒå±€`<br>`feat: å®ç°æœç´¢è¡¨å•`<br>`feat: é›†æˆæ—¥å†é€‰æ‹©ç»„ä»¶` |
| **Day 3** | é¦–é¡µåŠŸèƒ½å®Œå–„ | 1. çƒ­é—¨æ¨èå±•ç¤º<br>2. æœç´¢å†å²<br>3. é¡µé¢è·³è½¬ | `feature/home-page` | `feat: æ·»åŠ çƒ­é—¨æ¨è`<br>`feat: å®ç°æœç´¢å†å²` |
| **Day 4** | **ã€è”è°ƒå¼€å§‹ã€‘**åˆ—è¡¨é¡µæ¡†æ¶ | 1. **åˆ›å»ºçœŸå®api.ts**<br>2. **æ›¿æ¢Mock API**<br>3. åˆ—è¡¨é¡µå¸ƒå±€<br>4. **åŸºç¡€åˆ—è¡¨æ¸²æŸ“** | `feature/hotel-list` | `refactor: åˆ›å»ºçœŸå®APIæœåŠ¡`<br>`refactor: æ›¿æ¢Mock APIä¸ºçœŸå®API`<br>`feat: å®ç°åˆ—è¡¨é¡µé¢å¸ƒå±€` |
| **Day 5** | åˆ—è¡¨åŠŸèƒ½å®Œå–„ | 1. **éª¨æ¶å±**åŠ è½½<br>2. ç­›é€‰æ ï¼ˆä»·æ ¼ã€è¯„åˆ†ï¼‰<br>3. æ’åºåŠŸèƒ½ | `feature/hotel-list` | `feat: æ·»åŠ éª¨æ¶å±åŠ è½½`<br>`feat: å®ç°ç­›é€‰åŠŸèƒ½`<br>`feat: å®ç°æ’åºåŠŸèƒ½` |
| **Day 6** | è¯¦æƒ…é¡µæ¡†æ¶ | 1. è¯¦æƒ…é¡µå¸ƒå±€<br>2. å›¾ç‰‡è½®æ’­<br>3. é…’åº—åŸºæœ¬ä¿¡æ¯ | `feature/hotel-detail` | `feat: å®ç°è¯¦æƒ…é¡µå¸ƒå±€`<br>`feat: å®ç°å›¾ç‰‡è½®æ’­` |
| **Day 7** | è¯¦æƒ…é¡µæˆ¿å‹åˆ—è¡¨ | 1. æˆ¿å‹åˆ—è¡¨å±•ç¤º<br>2. ä»·æ ¼æ’åºï¼ˆä½â†’é«˜ï¼‰<br>3. é¢„è®¢æŒ‰é’® | `feature/hotel-detail` | `feat: å®ç°æˆ¿å‹åˆ—è¡¨`<br>`feat: å®ç°ä»·æ ¼æ’åº` |

### Week 2ï¼šåˆ›æ–°åŠŸèƒ½ + ä¼˜åŒ–å®Œå–„

| å¤©æ•° | å¼€å‘ä»»åŠ¡ | è¯¦ç»†å†…å®¹ | Gitåˆ†æ”¯ | Commitç¤ºä¾‹ |
|-----|---------|---------|---------|-----------|
| **Day 8** | **ã€åˆ›æ–°1ã€‘è™šæ‹Ÿæ»šåŠ¨å®ç°** | 1. å¼•å…¥@tarojs/componentsè™šæ‹Ÿæ»šåŠ¨<br>2. é‡æ„åˆ—è¡¨é¡µä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨<br>3. æ€§èƒ½å¯¹æ¯”æµ‹è¯• | `feature/virtual-scroll` | `feat: å®ç°è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨`<br>`perf: ä¼˜åŒ–é•¿åˆ—è¡¨æ¸²æŸ“æ€§èƒ½` |
| **Day 9** | è™šæ‹Ÿæ»šåŠ¨è°ƒä¼˜ | 1. åŠ¨æ€é«˜åº¦è®¡ç®—<br>2. æ»šåŠ¨ä¼˜åŒ–<br>3. éª¨æ¶å±é…åˆ | `feature/virtual-scroll` | `perf: ä¼˜åŒ–è™šæ‹Ÿæ»šåŠ¨æ€§èƒ½`<br>`feat: æ”¯æŒåŠ¨æ€é«˜åº¦` |
| **Day 10** | **ã€åˆ›æ–°2ã€‘LBSå®šä½å®ç°** | 1. **å®ç°getLocationApi**<br>2. H5/å°ç¨‹åºAPIé€‚é…<br>3. å®šä½æƒé™å¤„ç† | `feature/location` | `feat: å®ç°LBSå®šä½åŠŸèƒ½`<br>`feat: é€‚é…H5å’Œå°ç¨‹åºå®šä½API` |
| **Day 11** | LBSåŠŸèƒ½å®Œå–„ | 1. **"è·æˆ‘æœ€è¿‘"æ’åº**<br>2. **è·ç¦»æ˜¾ç¤º**<br>3. å®šä½å¤±è´¥é™çº§ | `feature/location` | `feat: å®ç°è·ç¦»æ’åº`<br>`feat: æ˜¾ç¤ºé…’åº—è·ç¦»`<br>`feat: æ·»åŠ å®šä½å¤±è´¥å¤„ç†` |
| **Day 12** | æ€§èƒ½ä¼˜åŒ– + æ‡’åŠ è½½ | 1. **å›¾ç‰‡æ‡’åŠ è½½**<br>2. åˆ—è¡¨é¡µæ— é™åŠ è½½<br>3. ä¸‹æ‹‰åˆ·æ–° | `feature/performance` | `feat: å®ç°å›¾ç‰‡æ‡’åŠ è½½`<br>`feat: å®ç°æ— é™æ»šåŠ¨åŠ è½½`<br>`feat: å®ç°ä¸‹æ‹‰åˆ·æ–°` |
| **Day 13** | ç§»åŠ¨ç«¯æµ‹è¯• | 1. åŠŸèƒ½æµ‹è¯•<br>2. **H5ç«¯æµ‹è¯•**<br>3. **å°ç¨‹åºç«¯æµ‹è¯•**ï¼ˆå¯é€‰ï¼‰<br>4. Bugä¿®å¤ | `bugfix/day13` | `test: å®Œæˆç§»åŠ¨ç«¯åŠŸèƒ½æµ‹è¯•`<br>`fix: ä¿®å¤H5ç«¯å…¼å®¹æ€§é—®é¢˜` |
| **Day 14** | Bugä¿®å¤ + æ¼”ç¤ºå‡†å¤‡ | 1. Bugä¿®å¤<br>2. ä»£ç ä¼˜åŒ–<br>3. å‡†å¤‡æ¼”ç¤ºæ•°æ® | - | `fix: ä¿®å¤åˆ—è¡¨æ»šåŠ¨é—®é¢˜`<br>`chore: å‡†å¤‡æ¼”ç¤ºç¯å¢ƒ` |

---

## ğŸŒ³ Gitåˆ†æ”¯ç­–ç•¥

### åˆ†æ”¯åˆ—è¡¨

```
main (ä¸»åˆ†æ”¯)
â”œâ”€â”€ feature/setup-mobile      # ç¯å¢ƒæ­å»º
â”œâ”€â”€ feature/home-page        # é¦–é¡µ/æŸ¥è¯¢é¡µ
â”œâ”€â”€ feature/hotel-list      # é…’åº—åˆ—è¡¨é¡µ
â”œâ”€â”€ feature/hotel-detail     # é…’åº—è¯¦æƒ…é¡µ
â”œâ”€â”€ feature/virtual-scroll   # è™šæ‹Ÿæ»šåŠ¨ï¼ˆåˆ›æ–°ï¼‰
â”œâ”€â”€ feature/location        # LBSå®šä½ï¼ˆåˆ›æ–°ï¼‰
â”œâ”€â”€ feature/performance     # æ€§èƒ½ä¼˜åŒ–
â””â”€â”€ bugfix/day13          # Bugä¿®å¤
```

### åˆ†æ”¯æ“ä½œæµç¨‹

```bash
# 1. æ‹‰å–æœ€æ–°mainåˆ†æ”¯
git checkout main
git pull origin main

# 2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/hotel-list

# 3. å¼€å‘å¹¶æäº¤
git add .
git commit -m "feat: å®ç°é…’åº—åˆ—è¡¨é¡µé¢"

# 4. æ¨é€åˆ°è¿œç¨‹
git push origin feature/hotel-list

# 5. åˆ›å»ºPRå¹¶åˆå¹¶
```

### åˆå¹¶æ—¶é—´èŠ‚ç‚¹

| æ—¥æœŸ | åˆå¹¶åˆ†æ”¯ | æ£€æŸ¥ç‚¹ |
|-----|---------|--------|
| Day 1 æ™šä¸Š | `feature/setup-mobile` | M1: ç¯å¢ƒæ­å»ºå®Œæˆ |
| Day 3 æ™šä¸Š | `feature/home-page` | é¦–é¡µåŠŸèƒ½å¯ç”¨ |
| Day 5 æ™šä¸Š | `feature/hotel-list` | åˆ—è¡¨é¡µåŸºç¡€åŠŸèƒ½å¯ç”¨ |
| Day 7 æ™šä¸Š | `feature/hotel-detail` | M3: æ‰€æœ‰åŸºç¡€é¡µé¢å®Œæˆ |
| Day 9 æ™šä¸Š | `feature/virtual-scroll` | M4: è™šæ‹Ÿæ»šåŠ¨å®Œæˆ |
| Day 11 æ™šä¸Š | `feature/location` | LBSå®šä½å®Œæˆ |
| Day 12 æ™šä¸Š | `feature/performance` | æ€§èƒ½ä¼˜åŒ–å®Œæˆ |
| Day 13 æ™šä¸Š | `bugfix/day13` | Bugä¿®å¤å®Œæˆ |

---

## ğŸ“ Conventional Commits æäº¤ç¤ºä¾‹

```bash
# æ–°åŠŸèƒ½
git commit -m "feat(home): å®ç°é¦–é¡µæœç´¢è¡¨å•"
git commit -m "feat(list): å®ç°é…’åº—åˆ—è¡¨æ¸²æŸ“"
git commit -m "feat(detail): å®ç°å›¾ç‰‡è½®æ’­ç»„ä»¶"

# åˆ›æ–°åŠŸèƒ½
git commit -m "feat(virtual-scroll): å®ç°è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–"
git commit -m "feat(location): å®ç°LBSå®šä½åŠŸèƒ½"

# æ€§èƒ½ä¼˜åŒ–
git commit -m "perf: ä¼˜åŒ–å›¾ç‰‡åŠ è½½æ€§èƒ½"
git commit -m "perf: ä¼˜åŒ–åˆ—è¡¨æ¸²æŸ“æ€§èƒ½"

# Bugä¿®å¤
git commit -m "fix: ä¿®å¤æ»šåŠ¨æ—¶åˆ—è¡¨å¡é¡¿é—®é¢˜"
git commit -m "fix: ä¿®å¤H5ç«¯å®šä½å¤±è´¥é—®é¢˜"

# ä»£ç é‡æ„
git commit -m "refactor: å°†Mock APIæ›¿æ¢ä¸ºçœŸå®API"

# æµ‹è¯•
git commit -m "test: å®ŒæˆH5ç«¯åŠŸèƒ½æµ‹è¯•"
git commit -m "test: å®Œæˆå°ç¨‹åºç«¯å…¼å®¹æ€§æµ‹è¯•"
```

---

## ğŸ¯ åˆ›æ–°åŠŸèƒ½å®ç°ç»†èŠ‚

### 1. è™šæ‹Ÿæ»šåŠ¨ï¼ˆDay 8-9ï¼‰

#### å®ç°æ–¹æ¡ˆ

```tsx
/**
 * pages/list/index.tsx
 * ä½¿ç”¨ @tarojs/components çš„ VirtualList
 */
import { ScrollView, View } from '@tarojs/components';
import VirtualList from '@tarojs/components/virtual-list';

const HotelList = ({ hotels }) => {
  const rowData = (hotel, index) => {
    return (
      <View className="hotel-item">
        {/* é…’åº—å¡ç‰‡å†…å®¹ */}
      </View>
    );
  };

  return (
    <VirtualList
      height={window.innerHeight} // è§†å£é«˜åº¦
      width="100%"
      rowData={hotels}
      rowHeight={150} // æ¯é¡¹å›ºå®šé«˜åº¦
      renderRow={rowData}
      overscanCount={5} // é¢„æ¸²æŸ“æ•°é‡
    />
  );
};
```

#### è¯„åˆ†è¦ç‚¹

| è¯„åˆ†é¡¹ | å®ç°æ–¹å¼ | éªŒè¯æ–¹æ³• |
|-------|---------|---------|
| æŠ€æœ¯å¤æ‚åº¦ï¼ˆ3åˆ†ï¼‰ | åªæ¸²æŸ“å¯è§†åŒºåŸŸåˆ—è¡¨é¡¹ | Chrome DevToolsæŸ¥çœ‹DOMæ•°é‡ |
| æ€§èƒ½ä¼˜åŒ– | é…åˆéª¨æ¶å±æå‡ä½“éªŒ | åˆ—è¡¨æ»šåŠ¨æµç•…åº¦ |

---

### 2. LBSå®šä½ï¼ˆDay 10-11ï¼‰

#### å®ç°æ–¹æ¡ˆ

```tsx
/**
 * hooks/useLocation.ts
 * è‡ªå®šä¹‰å®šä½Hook
 */
import { useState, useEffect } from 'react';
import Taro from '@tarojs/taro';
import { getLocationApi } from '../services/mockApi';

export const useLocation = () => {
  const [location, setLocation] = useState<{ lat: number; lng: number } | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const getLocation = async () => {
    setLoading(true);
    setError(null);

    try {
      const loc = await getLocationApi();
      setLocation(loc);
    } catch (err: any) {
      setError(err.message || 'å®šä½å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  return { location, loading, error, getLocation };
};

// ä½¿ç”¨
const HomePage = () => {
  const { location, loading, getLocation } = useLocation();

  return (
    <View>
      <Button onClick={getLocation} loading={loading}>
        {loading ? 'å®šä½ä¸­...' : 'è·å–å½“å‰ä½ç½®'}
      </Button>
      {location && <Text>å·²å®šä½</Text>}
    </View>
  );
};
```

#### H5/å°ç¨‹åºé€‚é…

```typescript
// services/mockApi.ts
export const getLocationApi = async () => {
  // H5ç¯å¢ƒ
  if (process.env.TARO_ENV === 'h5') {
    return new Promise((resolve, reject) => {
      navigator.geolocation.getCurrentPosition(
        pos => resolve({ lat: pos.coords.latitude, lng: pos.coords.longitude }),
        err => reject(err)
      );
    });
  }

  // å°ç¨‹åºç¯å¢ƒ
  if (process.env.TARO_ENV === 'weapp') {
    const res = await Taro.getLocation();
    return { lat: res.latitude, lng: res.longitude };
  }
};
```

#### è¯„åˆ†è¦ç‚¹

| è¯„åˆ†é¡¹ | å®ç°æ–¹å¼ | éªŒè¯æ–¹æ³• |
|-------|---------|---------|
| é¡¹ç›®åˆ›æ–°æ€§ï¼ˆ5åˆ†ï¼‰ | "è·æˆ‘æœ€è¿‘"æ’åºã€æ˜¾ç¤ºè·ç¦» | æ’åºåé¦–é¡¹ä¸ºæœ€è¿‘é…’åº— |
| æŠ€æœ¯å±•ç¤º | H5/å°ç¨‹åºAPIé€‚é… | ä¸¤ç«¯éƒ½èƒ½æ­£å¸¸å®šä½ |

---

## ğŸ“ æ¨èçš„ç§»åŠ¨ç«¯ç›®å½•ç»“æ„

```
mini-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/              # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ HotelCard/         # é…’åº—å¡ç‰‡
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ SearchBar/         # æœç´¢æ 
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ Calendar/          # æ—¥å†é€‰æ‹©ï¼ˆæˆå‘˜Cæä¾›ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ FilterBar/         # ç­›é€‰æ 
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ ImageSwiper/       # å›¾ç‰‡è½®æ’­
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ Skeleton/          # éª¨æ¶å±
â”‚   â”‚       â””â”€â”€ index.tsx
â”‚   â”œâ”€â”€ pages/                # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ home/             # é¦–é¡µ/æŸ¥è¯¢é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SearchForm.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ HotRecommend.tsx
â”‚   â”‚   â”‚   â””â”€â”€ service.ts
â”‚   â”‚   â”œâ”€â”€ list/             # åˆ—è¡¨é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HotelList.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FilterBar.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ VirtualList.tsx  # è™šæ‹Ÿæ»šåŠ¨
â”‚   â”‚   â”‚   â””â”€â”€ service.ts
â”‚   â”‚   â””â”€â”€ detail/           # è¯¦æƒ…é¡µ
â”‚   â”‚       â”œâ”€â”€ index.tsx
â”‚   â”‚       â”œâ”€â”€ components/
â”‚   â”‚       â”‚   â”œâ”€â”€ ImageSwiper.tsx
â”‚   â”‚       â”‚   â”œâ”€â”€ RoomList.tsx
â”‚   â”‚       â”‚   â””â”€â”€ BookButton.tsx
â”‚   â”‚       â””â”€â”€ service.ts
â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰hooks
â”‚   â”‚   â”œâ”€â”€ useLocation.ts    # å®šä½Hook
â”‚   â”‚   â”œâ”€â”€ useVirtualList.ts # è™šæ‹Ÿæ»šåŠ¨Hook
â”‚   â”‚   â””â”€â”€ useRequest.ts    # è¯·æ±‚Hook
â”‚   â”œâ”€â”€ services/             # APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ mockApi.ts        # Mock API
â”‚   â”‚   â”œâ”€â”€ api.ts           # çœŸå®API
â”‚   â”‚   â””â”€â”€ types.ts         # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ date.ts          # æ—¥æœŸå¤„ç†
â”‚   â”‚   â””â”€â”€ distance.ts      # è·ç¦»è®¡ç®—
â”‚   â”œâ”€â”€ styles/              # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ app.config.ts        # Taroåº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ app.tsx
â”‚   â””â”€â”€ app.scss
â”œâ”€â”€ project.h5.json          # H5ç«¯é…ç½®
â”œâ”€â”€ project.weapp.json       # å°ç¨‹åºç«¯é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

---

## ğŸ¯ æ¯æ—¥æ£€æŸ¥æ¸…å•

### Day 1 æ£€æŸ¥æ¸…å•
- [ ] Taroé¡¹ç›®èƒ½æ­£å¸¸å¯åŠ¨ï¼ˆH5ï¼‰
- [ ] NutUIç»„ä»¶æ­£å¸¸æ˜¾ç¤º
- [ ] è·¯ç”±é…ç½®å®Œæˆ
- [ ] Mock APIæœåŠ¡å¯ç”¨
- [ ] Gitåˆ†æ”¯å·²åˆ›å»ºå¹¶æ¨é€

### Day 2-3 æ£€æŸ¥æ¸…å•
- [ ] é¦–é¡µå¸ƒå±€å®Œæˆ
- [ ] æœç´¢è¡¨å•å¯æ­£å¸¸è¾“å…¥
- [ ] æ—¥å†ç»„ä»¶å¯é€‰æ‹©æ—¥æœŸ
- [ ] æœç´¢å¯è·³è½¬åˆ°åˆ—è¡¨é¡µ

### Day 4-5 æ£€æŸ¥æ¸…å•
- [ ] åˆ—è¡¨é¡µå¯æ­£å¸¸æ˜¾ç¤º
- [ ] éª¨æ¶å±åŠ è½½æ­£å¸¸
- [ ] ç­›é€‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] æ’åºåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] ä¸‹æ‹‰åˆ·æ–°å¯ç”¨
- [ ] ä¸Šæ‹‰åŠ è½½æ›´å¤šå¯ç”¨

### Day 6-7 æ£€æŸ¥æ¸…å•
- [ ] è¯¦æƒ…é¡µå¸ƒå±€å®Œæˆ
- [ ] å›¾ç‰‡è½®æ’­æ­£å¸¸æ»‘åŠ¨
- [ ] æˆ¿å‹åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º
- [ ] ä»·æ ¼æ’åºæ­£å¸¸å·¥ä½œ
- [ ] é¢„è®¢æŒ‰é’®å¯ç‚¹å‡»

### Day 8-9 æ£€æŸ¥æ¸…å•ï¼ˆè™šæ‹Ÿæ»šåŠ¨ï¼‰
- [ ] è™šæ‹Ÿæ»šåŠ¨æ­£å¸¸å·¥ä½œ
- [ ] åˆ—è¡¨æ»šåŠ¨æµç•…
- [ ] DOMæ•°é‡å‡å°‘ï¼ˆåªæ¸²æŸ“å¯è§é¡¹ï¼‰
- [ ] é…åˆéª¨æ¶å±åŠ è½½

### Day 10-11 æ£€æŸ¥æ¸…å•ï¼ˆLBSå®šä½ï¼‰
- [ ] H5ç«¯å®šä½æ­£å¸¸
- [ ] å°ç¨‹åºç«¯å®šä½æ­£å¸¸ï¼ˆå¦‚å¼€å‘ï¼‰
- [ ] "è·æˆ‘æœ€è¿‘"æ’åºæ­£ç¡®
- [ ] è·ç¦»æ˜¾ç¤ºæ­£ç¡®
- [ ] å®šä½å¤±è´¥æœ‰é™çº§æ–¹æ¡ˆ

### Day 12 æ£€æŸ¥æ¸…å•ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
- [ ] å›¾ç‰‡æ‡’åŠ è½½æ­£å¸¸
- [ ] æ— é™åŠ è½½å¯ç”¨
- [ ] ä¸‹æ‹‰åˆ·æ–°å¯ç”¨
- [ ] é¡µé¢æ€§èƒ½è‰¯å¥½

### Day 13-14 æ£€æŸ¥æ¸…å•
- [ ] H5ç«¯åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] å°ç¨‹åºç«¯æµ‹è¯•é€šè¿‡ï¼ˆå¯é€‰ï¼‰
- [ ] æ— ä¸¥é‡Bug
- [ ] æ¼”ç¤ºæ•°æ®å‡†å¤‡å®Œæˆ
- [ ] ä»£ç æ•´æ´æ— warning

---

## ğŸ“Š æˆå‘˜Aå·¥ä½œé‡è¯„ä¼°

| åŠŸèƒ½æ¨¡å— | å·¥ä½œé‡ | å æ¯” |
|---------|--------|------|
| ç¯å¢ƒæ­å»º | 0.5å¤© | 3.6% |
| é¦–é¡µ/æŸ¥è¯¢é¡µ | 2.5å¤© | 17.9% |
| é…’åº—åˆ—è¡¨é¡µ | 4å¤© | 28.6% |
| é…’åº—è¯¦æƒ…é¡µ | 3å¤© | 21.4% |
| è™šæ‹Ÿæ»šåŠ¨ï¼ˆåˆ›æ–°ï¼‰ | 2å¤© | 14.3% |
| LBSå®šä½ï¼ˆåˆ›æ–°ï¼‰ | 1.5å¤© | 10.7% |
| æµ‹è¯•+Bugä¿®å¤ | 0.5å¤© | 3.6% |
| **æ€»è®¡** | **14å¤©** | **100%** |

---

## ğŸ”— ä¸å…¶ä»–æˆå‘˜çš„åä½œèŠ‚ç‚¹

| æ—¶é—´ | ä¸æˆå‘˜Cï¼ˆåç«¯ï¼‰åä½œ | ä¸æˆå‘˜Bï¼ˆPCç«¯ï¼‰åä½œ |
|-----|-------------------|-------------------|
| Day 1 | - | - |
| Day 4 | ç¡®è®¤APIæ¥å£è§„èŒƒ<br>æ›¿æ¢Mockä¸ºçœŸå®API | - |
| Day 7 | è”è°ƒé…’åº—è¯¦æƒ…API | - |
| Day 11 | æµ‹è¯•LBSå®šä½API | - |
| Day 14 | é›†æˆæµ‹è¯•éªŒæ”¶ | æµ‹è¯•PCç«¯â†’ç§»åŠ¨ç«¯æ•°æ®æµ |

---

## ğŸ“± Taro å¤šç«¯å‘å¸ƒç›®æ ‡

### H5ç«¯ï¼ˆå¿…é€‰ï¼‰

```bash
# å¼€å‘
npm run dev:h5

# æ„å»º
npm run build:h5

# è¾“å‡ºç›®å½•
dist/
```

### å¾®ä¿¡å°ç¨‹åºï¼ˆå¯é€‰ï¼‰

```bash
# å¼€å‘
npm run dev:weapp

# æ„å»º
npm run build:weapp

# è¾“å‡ºç›®å½•
dist/
```

### å¤šç«¯å·®å¼‚å¤„ç†

```typescript
// æ ¹æ®å¹³å°ä½¿ç”¨ä¸åŒAPI
if (process.env.TARO_ENV === 'h5') {
  // H5 ç‰¹æœ‰ä»£ç 
  window.navigator.geolocation.getCurrentPosition(...)
} else if (process.env.TARO_ENV === 'weapp') {
  // å°ç¨‹åºç‰¹æœ‰ä»£ç 
  Taro.getLocation().then(...)
}
```

---

## ğŸ“ å­¦ä¹ èµ„æº

### Taro å®˜æ–¹æ–‡æ¡£
- å®˜ç½‘ï¼šhttps://taro-docs.jd.com/
- React æŒ‡å—ï¼šhttps://taro-docs.jd.com/tutorial
- ç»„ä»¶åº“ï¼šhttps://taro-docs.jd.com/components

### NutUI ç»„ä»¶åº“
- å®˜ç½‘ï¼šhttps://nutui.jd.com/
- Taro ç‰ˆæœ¬ï¼šhttps://nutui.jd.com/taro/

### è™šæ‹Ÿæ»šåŠ¨å‚è€ƒ
- Taro VirtualListæ–‡æ¡£
- react-window æºç å‚è€ƒ

### LBSå®šä½å‚è€ƒ
- H5 Geolocation APIï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/API/Geolocation
- å¾®ä¿¡å°ç¨‹åºå®šä½ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/api/location/wx.getLocation.html

---

> æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0
> æœ€åæ›´æ–°ï¼š2025-02-13
> çŠ¶æ€ï¼šå¾…ç¡®è®¤åå¼€å§‹æ‰§è¡Œ
